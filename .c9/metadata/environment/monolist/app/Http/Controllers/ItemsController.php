{"filter":false,"title":"ItemsController.php","tooltip":"/monolist/app/Http/Controllers/ItemsController.php","undoManager":{"mark":34,"position":34,"stack":[[{"start":{"row":0,"column":0},"end":{"row":48,"column":1},"action":"remove","lines":["<?php","","namespace App\\Http\\Controllers;","","use Illuminate\\Http\\Request;","","use App\\Http\\Controllers\\Controller;","","use App\\Item;","","class ItemUserController extends Controller","{","    public function want()","    {","        $itemCode = request()->itemCode;","","        // Search items from \"itemCode\"","        $client = new \\RakutenRws_Client();","        $client->setApplicationId(env('RAKUTEN_APPLICATION_ID'));","        $rws_response = $client->execute('IchibaItemSearch', [","            'itemCode' => $itemCode,","        ]);","        $rws_item = $rws_response->getData()['Items'][0]['Item'];","","        // create Item, or get Item if an item is found","        $item = Item::firstOrCreate([","            'code' => $rws_item['itemCode'],","            'name' => $rws_item['itemName'],","            'url' => $rws_item['itemUrl'],","            // remove \"?_ex=128x128\" because its size is defined","            'image_url' => str_replace('?_ex=128x128', '', $rws_item['mediumImageUrls'][0]['imageUrl']),","        ]);","","        \\Auth::user()->want($item->id);","","        return redirect()->back();","    }","","    public function dont_want()","    {","        $itemCode = request()->itemCode;","","        if (\\Auth::user()->is_wanting($itemCode)) {","            $itemId = Item::where('code', $itemCode)->first()->id;","            \\Auth::user()->dont_want($itemId);","        }","        return redirect()->back();","    }","}"],"id":6}],[{"start":{"row":0,"column":0},"end":{"row":39,"column":2},"action":"insert","lines":["<?php ","use \\App\\Item;","","  class ItemsController extends Controller","  {","","    public function create()","    {","        $keyword = request()->keyword;","        $items = [];","        if ($keyword) {","            $client = new \\RakutenRws_Client();","            $client->setApplicationId(env('RAKUTEN_APPLICATION_ID'));","","            $rws_response = $client->execute('IchibaItemSearch', [","                'keyword' => $keyword,","                'imageFlag' => 1,","                'hits' => 20,","            ]);","","            // Creating \"Item\" instance to make it easy to handle.（not saving）","            foreach ($rws_response->getData()['Items'] as $rws_item) {","                $item = new Item();","                $item->code = $rws_item['Item']['itemCode'];","                $item->name = $rws_item['Item']['itemName'];","                $item->url = $rws_item['Item']['itemUrl'];","                $item->image_url = str_replace('?_ex=128x128', '', $rws_item['Item']['mediumImageUrls'][0]['imageUrl']);","                $items[] = $item;","            }","        }","","        return view('items.create', [","            'keyword' => $keyword,","            'items' => $items,","        ]);","    }","  }","  ","  ","?>"],"id":7}],[{"start":{"row":37,"column":1},"end":{"row":37,"column":2},"action":"remove","lines":[" "],"id":8},{"start":{"row":37,"column":0},"end":{"row":37,"column":1},"action":"remove","lines":[" "]},{"start":{"row":36,"column":3},"end":{"row":37,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":35,"column":5},"end":{"row":36,"column":0},"action":"insert","lines":["",""],"id":9},{"start":{"row":36,"column":0},"end":{"row":36,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":1,"column":14},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":14}],[{"start":{"row":2,"column":0},"end":{"row":2,"column":14},"action":"insert","lines":["use \\App\\Item;"],"id":15}],[{"start":{"row":2,"column":13},"end":{"row":2,"column":14},"action":"remove","lines":[";"],"id":16}],[{"start":{"row":2,"column":13},"end":{"row":2,"column":14},"action":"insert","lines":["\\"],"id":17},{"start":{"row":2,"column":14},"end":{"row":2,"column":15},"action":"insert","lines":["C"]}],[{"start":{"row":2,"column":15},"end":{"row":2,"column":16},"action":"insert","lines":["o"],"id":18},{"start":{"row":2,"column":16},"end":{"row":2,"column":17},"action":"insert","lines":["n"]},{"start":{"row":2,"column":17},"end":{"row":2,"column":18},"action":"insert","lines":["t"]},{"start":{"row":2,"column":18},"end":{"row":2,"column":19},"action":"insert","lines":["r"]},{"start":{"row":2,"column":19},"end":{"row":2,"column":20},"action":"insert","lines":["o"]},{"start":{"row":2,"column":20},"end":{"row":2,"column":21},"action":"insert","lines":["l"]},{"start":{"row":2,"column":21},"end":{"row":2,"column":22},"action":"insert","lines":["l"]},{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["e"]},{"start":{"row":2,"column":23},"end":{"row":2,"column":24},"action":"insert","lines":["r"]}],[{"start":{"row":2,"column":12},"end":{"row":2,"column":13},"action":"remove","lines":["m"],"id":19},{"start":{"row":2,"column":11},"end":{"row":2,"column":12},"action":"remove","lines":["e"]},{"start":{"row":2,"column":10},"end":{"row":2,"column":11},"action":"remove","lines":["t"]},{"start":{"row":2,"column":9},"end":{"row":2,"column":10},"action":"remove","lines":["I"]}],[{"start":{"row":2,"column":9},"end":{"row":2,"column":10},"action":"insert","lines":["H"],"id":20},{"start":{"row":2,"column":10},"end":{"row":2,"column":11},"action":"insert","lines":["t"]},{"start":{"row":2,"column":11},"end":{"row":2,"column":12},"action":"insert","lines":["t"]},{"start":{"row":2,"column":12},"end":{"row":2,"column":13},"action":"insert","lines":["p"]}],[{"start":{"row":2,"column":5},"end":{"row":2,"column":6},"action":"remove","lines":["A"],"id":21}],[{"start":{"row":2,"column":5},"end":{"row":2,"column":6},"action":"insert","lines":["a"],"id":22}],[{"start":{"row":2,"column":24},"end":{"row":2,"column":25},"action":"insert","lines":["s"],"id":23},{"start":{"row":2,"column":25},"end":{"row":2,"column":26},"action":"insert","lines":[";"]}],[{"start":{"row":2,"column":26},"end":{"row":2,"column":27},"action":"insert","lines":["s"],"id":24}],[{"start":{"row":2,"column":26},"end":{"row":2,"column":27},"action":"remove","lines":["s"],"id":26}],[{"start":{"row":2,"column":5},"end":{"row":2,"column":6},"action":"remove","lines":["a"],"id":27}],[{"start":{"row":2,"column":5},"end":{"row":2,"column":6},"action":"insert","lines":["A"],"id":28}],[{"start":{"row":2,"column":25},"end":{"row":2,"column":36},"action":"insert","lines":["\\Controller"],"id":29}],[{"start":{"row":0,"column":6},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":30}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":31},"action":"insert","lines":["namespace App\\Http\\Controllers;"],"id":31}],[{"start":{"row":37,"column":5},"end":{"row":38,"column":0},"action":"insert","lines":["",""],"id":32},{"start":{"row":38,"column":0},"end":{"row":38,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":38,"column":4},"end":{"row":47,"column":5},"action":"insert","lines":["public function show($id)","    {","      $item = Item::find($id);","      $want_users = $item->want_users;","","      return view('items.show', [","          'item' => $item,","          'want_users' => $want_users,","      ]);","    }"],"id":33}],[{"start":{"row":41,"column":38},"end":{"row":42,"column":0},"action":"insert","lines":["",""],"id":34},{"start":{"row":42,"column":0},"end":{"row":42,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":42,"column":6},"end":{"row":42,"column":38},"action":"insert","lines":["$want_users = $item->want_users;"],"id":35}],[{"start":{"row":42,"column":10},"end":{"row":42,"column":11},"action":"remove","lines":["t"],"id":36},{"start":{"row":42,"column":9},"end":{"row":42,"column":10},"action":"remove","lines":["n"]},{"start":{"row":42,"column":8},"end":{"row":42,"column":9},"action":"remove","lines":["a"]},{"start":{"row":42,"column":7},"end":{"row":42,"column":8},"action":"remove","lines":["w"]}],[{"start":{"row":42,"column":7},"end":{"row":42,"column":8},"action":"insert","lines":["h"],"id":37},{"start":{"row":42,"column":8},"end":{"row":42,"column":9},"action":"insert","lines":["a"]},{"start":{"row":42,"column":9},"end":{"row":42,"column":10},"action":"insert","lines":["v"]},{"start":{"row":42,"column":10},"end":{"row":42,"column":11},"action":"insert","lines":["e"]}],[{"start":{"row":42,"column":30},"end":{"row":42,"column":31},"action":"remove","lines":["t"],"id":38},{"start":{"row":42,"column":29},"end":{"row":42,"column":30},"action":"remove","lines":["n"]},{"start":{"row":42,"column":28},"end":{"row":42,"column":29},"action":"remove","lines":["a"]},{"start":{"row":42,"column":27},"end":{"row":42,"column":28},"action":"remove","lines":["w"]}],[{"start":{"row":42,"column":27},"end":{"row":42,"column":28},"action":"insert","lines":["h"],"id":39},{"start":{"row":42,"column":28},"end":{"row":42,"column":29},"action":"insert","lines":["a"]},{"start":{"row":42,"column":29},"end":{"row":42,"column":30},"action":"insert","lines":["v"]},{"start":{"row":42,"column":30},"end":{"row":42,"column":31},"action":"insert","lines":["e"]}],[{"start":{"row":46,"column":38},"end":{"row":47,"column":0},"action":"insert","lines":["",""],"id":40},{"start":{"row":47,"column":0},"end":{"row":47,"column":10},"action":"insert","lines":["          "]}],[{"start":{"row":47,"column":10},"end":{"row":47,"column":38},"action":"insert","lines":["'want_users' => $want_users,"],"id":41}],[{"start":{"row":47,"column":14},"end":{"row":47,"column":15},"action":"remove","lines":["t"],"id":42},{"start":{"row":47,"column":13},"end":{"row":47,"column":14},"action":"remove","lines":["n"]},{"start":{"row":47,"column":12},"end":{"row":47,"column":13},"action":"remove","lines":["a"]},{"start":{"row":47,"column":11},"end":{"row":47,"column":12},"action":"remove","lines":["w"]}],[{"start":{"row":47,"column":11},"end":{"row":47,"column":12},"action":"insert","lines":["h"],"id":43},{"start":{"row":47,"column":12},"end":{"row":47,"column":13},"action":"insert","lines":["a"]},{"start":{"row":47,"column":13},"end":{"row":47,"column":14},"action":"insert","lines":["v"]},{"start":{"row":47,"column":14},"end":{"row":47,"column":15},"action":"insert","lines":["e"]}],[{"start":{"row":47,"column":30},"end":{"row":47,"column":31},"action":"remove","lines":["t"],"id":44},{"start":{"row":47,"column":29},"end":{"row":47,"column":30},"action":"remove","lines":["n"]},{"start":{"row":47,"column":28},"end":{"row":47,"column":29},"action":"remove","lines":["a"]},{"start":{"row":47,"column":27},"end":{"row":47,"column":28},"action":"remove","lines":["w"]}],[{"start":{"row":47,"column":27},"end":{"row":47,"column":28},"action":"insert","lines":["h"],"id":45},{"start":{"row":47,"column":28},"end":{"row":47,"column":29},"action":"insert","lines":["a"]},{"start":{"row":47,"column":29},"end":{"row":47,"column":30},"action":"insert","lines":["v"]},{"start":{"row":47,"column":30},"end":{"row":47,"column":31},"action":"insert","lines":["e"]}]]},"ace":{"folds":[],"scrolltop":435,"scrollleft":0,"selection":{"start":{"row":38,"column":29},"end":{"row":38,"column":29},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":31,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1528439671992,"hash":"675f202a104959eb0959a70ad15e7cc17ff55743"}